import{_ as P,r,e as S,f as A,c as n,i as q,a as t,j as x,d as f,n as B,t as m,T as E,w as g,v as b,F as M,k as U,g as F,q as C,l as y,m as w,p as _,s as L,u as Q,o as u}from"./index-BhwZ-e1m.js";const Y={class:"submit-view"},$={key:0,class:"form-container glass-panel"},j={class:"form-group"},I={class:"form-group"},O={class:"form-group"},H={class:"clue-number"},K=["onUpdate:modelValue","placeholder"],R=["onClick"],Z={key:1,class:"success-message glass-panel"},G={class:"date-info"},J={__name:"SubmitView",setup(W){const c=r(""),i=r(""),a=r(["","","","",""]),p=r(!1),d=r({show:!1,message:"",type:""}),v=r(0),D=S(()=>{if(v.value===0)return"Tomorrow";const s=new Date,e=5.5*60*60*1e3,l=new Date(s.getTime()+e);return l.setDate(l.getDate()+v.value+1),l.toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"Asia/Kolkata"})}),T=()=>{a.value.length<10&&a.value.push("")},V=s=>{a.value.length>3&&a.value.splice(s,1)},h=(s,e="error")=>{d.value={show:!0,message:s,type:e},setTimeout(()=>{d.value.show=!1},4e3)},z=async()=>{try{const s=C(y(w,"waitingPuzzles")),e=await _(s),l=C(y(w,"approvedPuzzles")),o=await _(l);v.value=e.size+o.size}catch(s){console.error("Error fetching queue:",s),v.value=0}};A(()=>{z()});const N=async()=>{if(!c.value||!i.value||a.value.some(s=>!s.trim())){h("Please fill in all fields","error");return}try{await L(y(w,"waitingPuzzles"),{movieName:c.value,submittedBy:i.value,clues:a.value,createdAt:Q()}),p.value=!0,c.value="",i.value="",a.value=["","","","",""]}catch(s){console.error("Error submitting puzzle:",s),h("Failed to submit puzzle. Please try again.","error")}};return(s,e)=>(u(),n("div",Y,[q(E,{name:"slide-down"},{default:x(()=>[d.value.show?(u(),n("div",{key:0,class:B(["notification",d.value.type])},m(d.value.message),3)):f("",!0)]),_:1}),e[9]||(e[9]=t("h1",{class:"title"},"Publish a Puzzle",-1)),p.value?(u(),n("div",Z,[t("h2",null,"Thank You, "+m(i.value)+"!",1),e[7]||(e[7]=t("p",null,"Your puzzle has been submitted for review.",-1)),t("p",G,[e[6]||(e[6]=F("Estimated Publication Date: ",-1)),t("strong",null,m(D.value),1)]),e[8]||(e[8]=t("p",{class:"date-disclaimer"},"* Date might be sooner if queued puzzles are rejected",-1)),t("button",{onClick:e[2]||(e[2]=l=>{p.value=!1,z()}),class:"btn-secondary action-btn"}," ðŸ”„ Submit Another ")])):(u(),n("div",$,[t("div",j,[e[3]||(e[3]=t("label",null,"Your Username (for credit)",-1)),g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>i.value=l),type:"text",class:"input-field",placeholder:"e.g. MovieBuff99"},null,512),[[b,i.value]])]),t("div",I,[e[4]||(e[4]=t("label",null,"Movie Name",-1)),g(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>c.value=l),type:"text",class:"input-field",placeholder:"e.g. The Matrix"},null,512),[[b,c.value]])]),t("div",O,[e[5]||(e[5]=t("label",null,"Clues (Order: Hardest to Easiest)",-1)),(u(!0),n(M,null,U(a.value,(l,o)=>(u(),n("div",{key:o,class:"clue-input-group"},[t("span",H,"#"+m(o+1),1),g(t("input",{"onUpdate:modelValue":k=>a.value[o]=k,type:"text",class:"input-field",placeholder:`Clue #${o+1}`},null,8,K),[[b,a.value[o]]]),a.value.length>3?(u(),n("button",{key:0,onClick:k=>V(o),class:"btn-icon",title:"Remove clue"}," âœ• ",8,R)):f("",!0)]))),128)),a.value.length<10?(u(),n("button",{key:0,onClick:T,class:"btn-secondary small"}," âœ¨ Add Another Clue ")):f("",!0)]),t("button",{onClick:N,class:"btn-primary full-width"},"Submit for Approval")]))]))}},ee=P(J,[["__scopeId","data-v-e8b4e7e8"]]);export{ee as default};
