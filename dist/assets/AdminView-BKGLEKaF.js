import{_ as x,r as n,f as L,z as w,A as Q,c as a,a as t,s as h,F as A,u as E,q as y,g as f,h as c,i as _,j as m,o,d as T,t as d,B as P,C as N}from"./index-DfSsWp_F.js";const H={class:"admin-view"},I={key:0,class:"loading-state"},M={key:1,class:"dashboard"},O={class:"floating-sidebar"},G={key:0,class:"loading-state"},J={key:1,class:"empty-state glass-panel"},K={key:2,class:"empty-state glass-panel"},U={key:3,class:"empty-state glass-panel"},W={key:4,class:"puzzles-list"},X={class:"puzzle-header"},Y={class:"puzzle-info"},Z={class:"movie-title"},ee={class:"meta-info"},se={class:"submitter"},te={class:"clue-count"},le={key:0,class:"actions"},ae=["onClick"],oe=["onClick"],ne={class:"clues-section"},ue={class:"clues-list"},ie={class:"clue-number"},re={class:"clue-text"},ce={__name:"AdminView",setup(de){const b=Q(),k=n(!1),R=n(""),B=n("");n(""),n(!1);const j=n(!0),i=n([]),p=n([]),v=n([]),r=n(!1),u=n("queue"),q=async()=>{r.value=!0;try{console.log("Fetching pending puzzles...");const s=y(f(c,"puzzles"),_("status","==","pending")),e=await m(s);console.log("Query result:",e.size,"documents found"),i.value=e.docs.map(l=>(console.log("Document data:",l.id,l.data()),{id:l.id,...l.data()})),console.log("Pending puzzles:",i.value)}catch(s){console.error("Error fetching puzzles:",s),console.error("Error code:",s.code),console.error("Error message:",s.message)}finally{r.value=!1}},D=async()=>{r.value=!0;try{const s=y(f(c,"puzzles"),_("status","==","approved")),e=await m(s);p.value=e.docs.map(l=>({id:l.id,...l.data()}))}catch(s){console.error("Error fetching approved puzzles:",s)}finally{r.value=!1}},F=async()=>{r.value=!0;try{const s=y(f(c,"puzzles"),_("status","==","rejected")),e=await m(s);v.value=e.docs.map(l=>({id:l.id,...l.data()}))}catch(s){console.error("Error fetching rejected puzzles:",s)}finally{r.value=!1}},z=s=>{u.value=s,s==="queue"?q():s==="approved"?D():s==="rejected"&&F()};L(()=>{w.onAuthStateChanged(s=>{s?(k.value=!0,q()):b.push("/"),j.value=!1})});const S=async s=>{try{const e=P(c,"puzzles",s);await N(e,{status:"approved"}),i.value=i.value.filter(l=>l.id!==s)}catch(e){console.error("Error approving puzzle:",e),alert("Failed to approve puzzle")}},$=async s=>{try{const e=P(c,"puzzles",s);await N(e,{status:"rejected"}),i.value=i.value.filter(l=>l.id!==s)}catch(e){console.error("Error rejecting puzzle:",e),alert("Failed to reject puzzle")}},V=async()=>{try{await w.signOut(),k.value=!1,R.value="",B.value="",b.push("/")}catch(s){console.error("Error logging out:",s)}};return(s,e)=>(o(),a("div",H,[e[10]||(e[10]=t("h1",{class:"title"},"Admin Dashboard",-1)),j.value?(o(),a("div",I,[...e[3]||(e[3]=[t("div",{class:"spinner"},null,-1),t("p",null,"Checking authentication...",-1)])])):(o(),a("div",M,[t("div",O,[t("button",{onClick:e[0]||(e[0]=l=>z("queue")),class:h(["sidebar-btn",{active:u.value==="queue"}]),title:"Queue (Pending)"}," â³ ",2),t("button",{onClick:e[1]||(e[1]=l=>z("approved")),class:h(["sidebar-btn",{active:u.value==="approved"}]),title:"Approved"}," âœ¨ ",2),t("button",{onClick:e[2]||(e[2]=l=>z("rejected")),class:h(["sidebar-btn",{active:u.value==="rejected"}]),title:"Rejected"}," ðŸ—‘ï¸ ",2),e[4]||(e[4]=t("div",{class:"sidebar-divider"},null,-1)),t("button",{onClick:V,class:"sidebar-btn logout-btn",title:"Logout"}," ðŸ‘‹ ")]),r.value?(o(),a("div",G,[...e[5]||(e[5]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading puzzles...",-1)])])):u.value==="queue"&&i.value.length===0?(o(),a("div",J,[...e[6]||(e[6]=[t("p",null,"No pending puzzles to review.",-1)])])):u.value==="approved"&&p.value.length===0?(o(),a("div",K,[...e[7]||(e[7]=[t("p",null,"No approved puzzles yet.",-1)])])):u.value==="rejected"&&v.value.length===0?(o(),a("div",U,[...e[8]||(e[8]=[t("p",null,"No rejected puzzles.",-1)])])):(o(),a("div",W,[(o(!0),a(A,null,E(u.value==="queue"?i.value:u.value==="approved"?p.value:v.value,l=>(o(),a("div",{key:l.id,class:"puzzle-card glass-panel"},[t("div",X,[t("div",Y,[t("h3",Z,"ðŸŽ¬ "+d(l.movieName),1),t("div",ee,[t("span",se,"ðŸ‘¤ "+d(l.submittedBy),1),t("span",te,"ðŸ“ "+d(l.clues.length)+" clues",1)])]),u.value==="queue"?(o(),a("div",le,[t("button",{onClick:g=>S(l.id),class:"btn-approve"}," âœ“ Approve ",8,ae),t("button",{onClick:g=>$(l.id),class:"btn-reject"}," âœ• Reject ",8,oe)])):T("",!0)]),t("div",ne,[e[9]||(e[9]=t("h4",{class:"clues-title"},"Clues (Hardest â†’ Easiest)",-1)),t("ol",ue,[(o(!0),a(A,null,E(l.clues,(g,C)=>(o(),a("li",{key:C,class:"clue-item"},[t("span",ie,"#"+d(C+1),1),t("span",re,d(g),1)]))),128))])])]))),128))]))]))]))}},ve=x(ce,[["__scopeId","data-v-1cdce2c3"]]);export{ve as default};
